<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
<title type="text">{{ dev playground }}</title>
<subtitle type="text">A short tagline</subtitle>
<generator uri="https://github.com/mojombo/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="http://localhost:4000/feed.xml" />
<link rel="alternate" type="text/html" href="http://localhost:4000" />
<updated>2013-11-25T10:17:04+01:00</updated>
<id>http://localhost:4000/</id>
<author>
  <name>Stefano Corallo</name>
  <uri>http://localhost:4000/</uri>
  <email>stefanorg@gmail.com</email>
</author>


<entry>
  <title type="html"><![CDATA[Redirigere tutte le richieste http su https tramite Virtual Host]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/redirigere-richieste-http-to-https" />
  <id>http://localhost:4000/articles/redirigere-richieste-http-to-https</id>
  <published>2013-11-25T10:14:14+01:00</published>
  <updated>2013-11-25T10:14:14+01:00</updated>
  <author>
    <name>Stefano Corallo</name>
    <uri>http://localhost:4000</uri>
    <email>stefanorg@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;Su una applicazione sviluppata con Zend Framework 1, ho avuto la necessità di redirigere tutte le richieste http ad https. 
Nel mio caso, avendo accesso alla configurazione del server, posso modificare il Virtual Host.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Per abilitare il protocollo http su apache potete dare un’occhiata a questo mio altro post: &lt;a href=&quot;/articles/abilitare-apache-ssl-osx-lion&quot;&gt;Abilitare Apache SSL su OSX Lion&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;L’applicazione sviluppata con ZendFramework 1 è ospitata su un server CentOS 6.3 con webserver apache2.&lt;/p&gt;

&lt;p&gt;Modifico il file di configurazione del Virtual Host che si trova in &lt;code&gt;/etc/httpd/conf.d/ilmiosito.conf&lt;/code&gt; in questo modo&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#configurazione vhost porta 80&lt;/span&gt;
&amp;lt;VirtualHost ilmiosito.local:80&amp;gt;
        RewriteEngine on
        ReWriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;SERVER_PORT&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; !^443&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;#tutte le richieste http le redirigo su https&lt;/span&gt;
        RewriteRule ^/&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.*&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; https://%&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;HTTP_HOST&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NC,R,L&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
&amp;lt;/VirtualHost&amp;gt;

&lt;span class=&quot;c&quot;&gt;#configurazione vhost porta 443 https&lt;/span&gt;
&amp;lt;VirtualHost ilmiosito.local:443&amp;gt;
   DocumentRoot &lt;span class=&quot;s2&quot;&gt;&amp;quot;/var/www/ilmiosito/public&amp;quot;&lt;/span&gt;
   ServerName ilmiosito.local

   RewriteEngine on
   RewriteCond %&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;HTTP_HOST&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; ^ilmisito&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;NC&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
   RewriteRule ^&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;.*&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;https://ilmiosito.local&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;R&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;301,L&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;

   &lt;span class=&quot;c&quot;&gt;# This should be omitted in the production environment&lt;/span&gt;
   SetEnv APPLICATION_ENV production

   &amp;lt;Directory &lt;span class=&quot;s2&quot;&gt;&amp;quot;/var/www/ilmiosito/public&amp;quot;&lt;/span&gt;&amp;gt;
       Options Indexes MultiViews FollowSymLinks
       AllowOverride All
       Order allow,deny
       Allow from all
   &amp;lt;/Directory&amp;gt;

  ErrorLog logs/ssl/ilmiosito-error.log
  CustomLog logs/ssl/ilmiosito-access.log combined
  SSLEngine on
  SSLCertificateFile /etc/httpd/ssl/crt/ilmiosito.crt
  SSLCertificateKeyFile /etc/httpd/ssl/key/ilmisito.key
&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/redirigere-richieste-http-to-https&quot;&gt;Redirigere tutte le richieste http su https tramite Virtual Host&lt;/a&gt; was originally published by Stefano Corallo at &lt;a href=&quot;http://localhost:4000&quot;&gt;{{ dev playground }}&lt;/a&gt; on November 25, 2013.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/template" />
  <id>http://localhost:4000/articles/template</id>
  <published>2013-11-25T09:44:37+01:00</published>
  <updated>2013-11-25T09:44:37+01:00</updated>
  <author>
    <name>Stefano Corallo</name>
    <uri>http://localhost:4000</uri>
    <email>stefanorg@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;Dopo aver installato il server web apache, php54, mysql tramite macport (si trovano parecchie guide online basta googlare un pochino).&lt;/p&gt;

&lt;p&gt;Spostiamoci nella directory di installazione di apache&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16:54&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;~&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;cd /opt/local/apache2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;generiamo-le-chiavi-rsa-per-creare-i-certificati-da-utilizzare-con-apache&quot;&gt;Generiamo le chiavi rsa per creare i certificati da utilizzare con apache&lt;/h3&gt;

&lt;p&gt;Per prima cosa creiamo la directory dove genere le chiavi&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16:54&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo mkdir ssl
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Per generare le chiavi usiamo il seguente comando, senza inserire nessuna passphrase in modo tale che all’avvio di apache il servizio non si blocchi.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;sudo ssh-keygen -f ssl.key
Password:
Generating public/private rsa key pair.
Enter passphrase &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;no passphrase&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 
Enter same passphrase again: 
Your identification has been saved in ssl.key.
Your public key has been saved in ssl.key.pub.
The key fingerprint is:
19:c2:5b:ff:80:4b:30:77:96:72:c0:4c:39:ce:0c:f6 root@n4z4-mb.local
The key&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;s randomart image is:
+--&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; RSA 2048&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;----+
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       +o.       &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;     .o &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;. .     &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;     .&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       BEX       &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;      . S o      &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       . . o     &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;        .   .    &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;                 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;                 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
+-----------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sono state genere 2 chiavi, chiave pubblica &lt;code&gt;ssl.key.pub&lt;/code&gt; e chiave privata &lt;code&gt;ssl.key&lt;/code&gt; :&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:04&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;ls
ssl.key     ssl.key.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;generiamo-il-file-per-il-certificato-di-richiesta-requestcsr&quot;&gt;Generiamo il file per il certificato di richiesta request.csr&lt;/h3&gt;

&lt;p&gt;Dobbiamo generare il certificato di richiesta &lt;code&gt;request.csr&lt;/code&gt; che ci servirà per creare il certificato SSL. 
Per generare il certificato utilizziamo la chiave privata creata precedentemente. Dopo aver lanciato il comando ci verranno chieste alcune informazioni per la creazione del certificato di richiesta, ad esempio come CN mettete il vostro &lt;code&gt;ServerName&lt;/code&gt; nel mio caso &lt;code&gt;localhost&lt;/code&gt; &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:16&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo openssl req -new -key ssl.key -out request.csr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Dopo aver creato il certificato di richiesta possiamo generare il nostro certificato SSL &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:28&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo openssl x509 -req -days 365 -in request.csr -signkey ssl.key -out server.crt
Signature ok
&lt;span class=&quot;nv&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;........
Getting Private key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso che abbiamo generato il nostro certificato Self Signed &lt;code&gt;server.crt&lt;/code&gt;, non ci resta che configurare apache per servire le richieste &lt;code&gt;https&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;configuriamo-apache&quot;&gt;Configuriamo Apache&lt;/h3&gt;

&lt;p&gt;Spostiamoci nella directory &lt;code&gt;/opt/local/apache2/conf/extra&lt;/code&gt; modifichiamo il file di configurazione del modulo ssl di apache &lt;code&gt;httpd-ssl.conf&lt;/code&gt; cerchiamo le linee che iniziano con SSLCertificateFile, SSLCertificateKeyFile e modifichiamole come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;SSLCertificateFile &lt;span class=&quot;s2&quot;&gt;&amp;quot;/opt/local/apache2/ssl/server.crt&amp;quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#il nostro certificato ssl&lt;/span&gt;
SSLCertificateKeyFile &lt;span class=&quot;s2&quot;&gt;&amp;quot;/opt/local/apache2/ssl/ssl.key&amp;quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#la nostra chiave privata&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Controllate che nello stesso file siano commentate (inizino con #) le linee che iniziano con SSLCACertificatePath, SSLCARevocationPath&lt;/p&gt;

&lt;p&gt;Verifichiamo che nel file di configurazione di apache &lt;code&gt;/opt/local/apache2/httpd.conf&lt;/code&gt; sia abilitata la sezione ssl e in caso abilitiamola rimuovendo il commento # come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Secure (SSL/TLS) connections&lt;/span&gt;
Include conf/extra/httpd-ssl.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;configuriamo-il-vhost&quot;&gt;Configuriamo il vhost&lt;/h3&gt;
&lt;p&gt;Verifichiamo che nel file di configurazione di apache &lt;code&gt;/opt/local/apache2/httpd.conf&lt;/code&gt; sia abilitata la sezione Virtual Host e in caso abilitiamola rimuovendo il commento # come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Virtual hosts&lt;/span&gt;
Include conf/extra/httpd-vhosts.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso modifichiamo il virtual host ‘/opt/local/apache2/extra/httpd-vhosts.conf’ aggiungiamo sotto NameVirtualHost *:80 la riga NameVirtualHost *:443 in questo modo&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;NameVirtualHost *:80
NameVirtualHost *:443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ora possiamo configurare un virtual host ssl come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&amp;lt;VirtualHost *:443&amp;gt;
    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    SSLCertificateFile /private/etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /private/etc/apache2/ssl/ssl.key
    ServerName localhost &lt;span class=&quot;c&quot;&gt;#Questo e&amp;#39; lo stesso del CN utilizzato durante la generazione del certificato di richiesta request.csr&lt;/span&gt;
    DocumentRoot &lt;span class=&quot;s2&quot;&gt;&amp;quot;/path/al/mio/sito/web&amp;quot;&lt;/span&gt;
&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso possiamo riavviare apache e collegarci al nostro nuovo sito in HTTPS.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:32&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;~/apache2-server/conf&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo /opt/local/etc/LaunchDaemons/org.macports.apache2/apache2.wrapper restart
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/template&quot;&gt;TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion&lt;/a&gt; was originally published by Stefano Corallo at &lt;a href=&quot;http://localhost:4000&quot;&gt;{{ dev playground }}&lt;/a&gt; on November 25, 2013.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Macports Abilitare Apache SSL su Mac OSX Lion]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/abilitare-apache-ssl-osx-lion" />
  <id>http://localhost:4000/articles/abilitare-apache-ssl-osx-lion</id>
  <published>2013-11-23T00:00:00+01:00</published>
  <updated>2013-11-23T00:00:00+01:00</updated>
  <author>
    <name>Stefano Corallo</name>
    <uri>http://localhost:4000</uri>
    <email>stefanorg@gmail.com</email>
  </author>
  <content type="html">&lt;p&gt;Dopo aver installato il server web apache, php54, mysql tramite macport (si trovano parecchie guide online basta googlare un pochino).&lt;/p&gt;

&lt;p&gt;Spostiamoci nella directory di installazione di apache&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16:54&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;~&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;cd /opt/local/apache2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;generiamo-le-chiavi-rsa-per-creare-i-certificati-da-utilizzare-con-apache&quot;&gt;Generiamo le chiavi rsa per creare i certificati da utilizzare con apache&lt;/h3&gt;

&lt;p&gt;Per prima cosa creiamo la directory dove genere le chiavi&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16:54&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo mkdir ssl
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Per generare le chiavi usiamo il seguente comando, senza inserire nessuna passphrase in modo tale che all’avvio di apache il servizio non si blocchi.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;sudo ssh-keygen -f ssl.key
Password:
Generating public/private rsa key pair.
Enter passphrase &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;no passphrase&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 
Enter same passphrase again: 
Your identification has been saved in ssl.key.
Your public key has been saved in ssl.key.pub.
The key fingerprint is:
19:c2:5b:ff:80:4b:30:77:96:72:c0:4c:39:ce:0c:f6 root@n4z4-mb.local
The key&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;s randomart image is:
+--&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; RSA 2048&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;----+
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       +o.       &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;     .o &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;. .     &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;     .&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;*&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;      &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       BEX       &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;      . S o      &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;       . . o     &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;        .   .    &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;                 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;                 &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt;
+-----------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sono state genere 2 chiavi, chiave pubblica &lt;code&gt;ssl.key.pub&lt;/code&gt; e chiave privata &lt;code&gt;ssl.key&lt;/code&gt; :&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:04&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;ls
ssl.key     ssl.key.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;generiamo-il-file-per-il-certificato-di-richiesta-requestcsr&quot;&gt;Generiamo il file per il certificato di richiesta request.csr&lt;/h3&gt;

&lt;p&gt;Dobbiamo generare il certificato di richiesta &lt;code&gt;request.csr&lt;/code&gt; che ci servirà per creare il certificato SSL. 
Per generare il certificato utilizziamo la chiave privata creata precedentemente. Dopo aver lanciato il comando ci verranno chieste alcune informazioni per la creazione del certificato di richiesta, ad esempio come CN mettete il vostro &lt;code&gt;ServerName&lt;/code&gt; nel mio caso &lt;code&gt;localhost&lt;/code&gt; &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:16&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo openssl req -new -key ssl.key -out request.csr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Dopo aver creato il certificato di richiesta possiamo generare il nostro certificato SSL &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:28&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/opt/local/apache2/ssl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo openssl x509 -req -days 365 -in request.csr -signkey ssl.key -out server.crt
Signature ok
&lt;span class=&quot;nv&quot;&gt;subject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;........
Getting Private key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso che abbiamo generato il nostro certificato Self Signed &lt;code&gt;server.crt&lt;/code&gt;, non ci resta che configurare apache per servire le richieste &lt;code&gt;https&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;configuriamo-apache&quot;&gt;Configuriamo Apache&lt;/h3&gt;

&lt;p&gt;Spostiamoci nella directory &lt;code&gt;/opt/local/apache2/conf/extra&lt;/code&gt; modifichiamo il file di configurazione del modulo ssl di apache &lt;code&gt;httpd-ssl.conf&lt;/code&gt; cerchiamo le linee che iniziano con SSLCertificateFile, SSLCertificateKeyFile e modifichiamole come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;SSLCertificateFile &lt;span class=&quot;s2&quot;&gt;&amp;quot;/opt/local/apache2/ssl/server.crt&amp;quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#il nostro certificato ssl&lt;/span&gt;
SSLCertificateKeyFile &lt;span class=&quot;s2&quot;&gt;&amp;quot;/opt/local/apache2/ssl/ssl.key&amp;quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#la nostra chiave privata&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Controllate che nello stesso file siano commentate (inizino con #) le linee che iniziano con SSLCACertificatePath, SSLCARevocationPath&lt;/p&gt;

&lt;p&gt;Verifichiamo che nel file di configurazione di apache &lt;code&gt;/opt/local/apache2/httpd.conf&lt;/code&gt; sia abilitata la sezione ssl e in caso abilitiamola rimuovendo il commento # come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Secure (SSL/TLS) connections&lt;/span&gt;
Include conf/extra/httpd-ssl.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;configuriamo-il-vhost&quot;&gt;Configuriamo il vhost&lt;/h3&gt;
&lt;p&gt;Verifichiamo che nel file di configurazione di apache &lt;code&gt;/opt/local/apache2/httpd.conf&lt;/code&gt; sia abilitata la sezione Virtual Host e in caso abilitiamola rimuovendo il commento # come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Virtual hosts&lt;/span&gt;
Include conf/extra/httpd-vhosts.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso modifichiamo il virtual host ‘/opt/local/apache2/extra/httpd-vhosts.conf’ aggiungiamo sotto NameVirtualHost *:80 la riga NameVirtualHost *:443 in questo modo&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;NameVirtualHost *:80
NameVirtualHost *:443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ora possiamo configurare un virtual host ssl come segue:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&amp;lt;VirtualHost *:443&amp;gt;
    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    SSLCertificateFile /private/etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /private/etc/apache2/ssl/ssl.key
    ServerName localhost &lt;span class=&quot;c&quot;&gt;#Questo e&amp;#39; lo stesso del CN utilizzato durante la generazione del certificato di richiesta request.csr&lt;/span&gt;
    DocumentRoot &lt;span class=&quot;s2&quot;&gt;&amp;quot;/path/al/mio/sito/web&amp;quot;&lt;/span&gt;
&amp;lt;/VirtualHost&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Adesso possiamo riavviare apache e collegarci al nostro nuovo sito in HTTPS.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;n4z4@n4z4-mb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;17:32&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;~/apache2-server/conf&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
-&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;gt;&amp;gt;sudo /opt/local/etc/LaunchDaemons/org.macports.apache2/apache2.wrapper restart
Password:
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/abilitare-apache-ssl-osx-lion&quot;&gt;Macports Abilitare Apache SSL su Mac OSX Lion&lt;/a&gt; was originally published by Stefano Corallo at &lt;a href=&quot;http://localhost:4000&quot;&gt;{{ dev playground }}&lt;/a&gt; on November 23, 2013.&lt;/p&gt;</content>
</entry>

</feed>
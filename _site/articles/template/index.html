<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion &#8211; {{ dev playground }}</title>
<meta name="description" content="TEMPLATE Macports Apache SSL su Mac OSX Lion">
<meta name="keywords" content="https, ssl, apache, osx, macports">


<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion">
<meta property="og:description" content="TEMPLATE Macports Apache SSL su Mac OSX Lion">
<meta property="og:url" content="http://localhost:4000/articles/template">
<meta property="og:site_name" content="{{ dev playground }}">





<link rel="canonical" href="http://localhost:4000/articles/template">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="{{ dev playground }} Feed">
<link rel="author" href="https://plus.google.com/118069744464640098068?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="http://localhost:4000/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://localhost:4000">{{ dev playground }}</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
		    <ul>
		        
				<li><a href="http://localhost:4000/about" >Chi Sono</a></li>
		        
				<li><a href="http://localhost:4000/articles" >Blog</a></li>
		        
		        <li><i class="icon-feed"></i> <a href="http://localhost:4000/feed.xml" title="Atom/RSS feed">Feed</a>
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-top">
    <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Stefano Corallo bio photo"></a>
<h3>Stefano Corallo</h3>
<p>Php zendframework doctrine jQuery and other cool stuff</p>


<a href="https://plus.google.com/118069744464640098068" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>


<a href="http://github.com/https://github.com/stefanorg" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <p>Dopo aver installato il server web apache, php54, mysql tramite macport (si trovano parecchie guide online basta googlare un pochino).</p>

<p>Spostiamoci nella directory di installazione di apache</p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>16:54<span class="o">)</span> - <span class="o">(</span>~<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;cd /opt/local/apache2
</code></pre></div>

<h3 id="generiamo-le-chiavi-rsa-per-creare-i-certificati-da-utilizzare-con-apache">Generiamo le chiavi rsa per creare i certificati da utilizzare con apache</h3>

<p>Per prima cosa creiamo la directory dove genere le chiavi</p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>16:54<span class="o">)</span> - <span class="o">(</span>/opt/local/apache2<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;sudo mkdir ssl
Password:
</code></pre></div>

<p>Per generare le chiavi usiamo il seguente comando, senza inserire nessuna passphrase in modo tale che all’avvio di apache il servizio non si blocchi.</p>

<div class="highlight"><pre><code class="bash">sudo ssh-keygen -f ssl.key
Password:
Generating public/private rsa key pair.
Enter passphrase <span class="o">(</span>empty <span class="k">for </span>no passphrase<span class="o">)</span>: 
Enter same passphrase again: 
Your identification has been saved in ssl.key.
Your public key has been saved in ssl.key.pub.
The key fingerprint is:
19:c2:5b:ff:80:4b:30:77:96:72:c0:4c:39:ce:0c:f6 root@n4z4-mb.local
The key<span class="err">&#39;</span>s randomart image is:
+--<span class="o">[</span> RSA 2048<span class="o">]</span>----+
<span class="p">|</span>       +o.       <span class="p">|</span>
<span class="p">|</span>     .o <span class="o">=</span>. .     <span class="p">|</span>
<span class="p">|</span>     .<span class="o">=</span>*<span class="o">=</span>.<span class="o">=</span>      <span class="p">|</span>
<span class="p">|</span>       BEX       <span class="p">|</span>
<span class="p">|</span>      . S o      <span class="p">|</span>
<span class="p">|</span>       . . o     <span class="p">|</span>
<span class="p">|</span>        .   .    <span class="p">|</span>
<span class="p">|</span>                 <span class="p">|</span>
<span class="p">|</span>                 <span class="p">|</span>
+-----------------+
</code></pre></div>

<p>Sono state genere 2 chiavi, chiave pubblica <code>ssl.key.pub</code> e chiave privata <code>ssl.key</code> :</p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>17:04<span class="o">)</span> - <span class="o">(</span>/opt/local/apache2/ssl<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;ls
ssl.key     ssl.key.pub
</code></pre></div>

<h3 id="generiamo-il-file-per-il-certificato-di-richiesta-requestcsr">Generiamo il file per il certificato di richiesta request.csr</h3>

<p>Dobbiamo generare il certificato di richiesta <code>request.csr</code> che ci servirà per creare il certificato SSL. 
Per generare il certificato utilizziamo la chiave privata creata precedentemente. Dopo aver lanciato il comando ci verranno chieste alcune informazioni per la creazione del certificato di richiesta, ad esempio come CN mettete il vostro <code>ServerName</code> nel mio caso <code>localhost</code> </p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>17:16<span class="o">)</span> - <span class="o">(</span>/opt/local/apache2/ssl<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;sudo openssl req -new -key ssl.key -out request.csr
</code></pre></div>

<p>Dopo aver creato il certificato di richiesta possiamo generare il nostro certificato SSL </p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>17:28<span class="o">)</span> - <span class="o">(</span>/opt/local/apache2/ssl<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;sudo openssl x509 -req -days 365 -in request.csr -signkey ssl.key -out server.crt
Signature ok
<span class="nv">subject</span><span class="o">=</span>........
Getting Private key
</code></pre></div>

<p>Adesso che abbiamo generato il nostro certificato Self Signed <code>server.crt</code>, non ci resta che configurare apache per servire le richieste <code>https</code>.</p>

<h3 id="configuriamo-apache">Configuriamo Apache</h3>

<p>Spostiamoci nella directory <code>/opt/local/apache2/conf/extra</code> modifichiamo il file di configurazione del modulo ssl di apache <code>httpd-ssl.conf</code> cerchiamo le linee che iniziano con SSLCertificateFile, SSLCertificateKeyFile e modifichiamole come segue:</p>

<div class="highlight"><pre><code class="bash">SSLCertificateFile <span class="s2">&quot;/opt/local/apache2/ssl/server.crt&quot;</span> <span class="c">#il nostro certificato ssl</span>
SSLCertificateKeyFile <span class="s2">&quot;/opt/local/apache2/ssl/ssl.key&quot;</span> <span class="c">#la nostra chiave privata</span>
</code></pre></div>

<p>Controllate che nello stesso file siano commentate (inizino con #) le linee che iniziano con SSLCACertificatePath, SSLCARevocationPath</p>

<p>Verifichiamo che nel file di configurazione di apache <code>/opt/local/apache2/httpd.conf</code> sia abilitata la sezione ssl e in caso abilitiamola rimuovendo il commento # come segue:</p>

<div class="highlight"><pre><code class="bash"><span class="c"># Secure (SSL/TLS) connections</span>
Include conf/extra/httpd-ssl.conf
</code></pre></div>

<h3 id="configuriamo-il-vhost">Configuriamo il vhost</h3>
<p>Verifichiamo che nel file di configurazione di apache <code>/opt/local/apache2/httpd.conf</code> sia abilitata la sezione Virtual Host e in caso abilitiamola rimuovendo il commento # come segue:</p>

<div class="highlight"><pre><code class="bash"><span class="c"># Virtual hosts</span>
Include conf/extra/httpd-vhosts.conf
</code></pre></div>

<p>Adesso modifichiamo il virtual host ‘/opt/local/apache2/extra/httpd-vhosts.conf’ aggiungiamo sotto NameVirtualHost *:80 la riga NameVirtualHost *:443 in questo modo</p>

<div class="highlight"><pre><code class="bash">NameVirtualHost *:80
NameVirtualHost *:443
</code></pre></div>

<p>Ora possiamo configurare un virtual host ssl come segue:</p>

<div class="highlight"><pre><code class="bash">&lt;VirtualHost *:443&gt;
    SSLEngine on
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    SSLCertificateFile /private/etc/apache2/ssl/server.crt
    SSLCertificateKeyFile /private/etc/apache2/ssl/ssl.key
    ServerName localhost <span class="c">#Questo e&#39; lo stesso del CN utilizzato durante la generazione del certificato di richiesta request.csr</span>
    DocumentRoot <span class="s2">&quot;/path/al/mio/sito/web&quot;</span>
&lt;/VirtualHost&gt;
</code></pre></div>

<p>Adesso possiamo riavviare apache e collegarci al nostro nuovo sito in HTTPS.</p>

<div class="highlight"><pre><code class="bash"><span class="o">(</span>n4z4@n4z4-mb<span class="o">)</span> - <span class="o">(</span>17:32<span class="o">)</span> - <span class="o">(</span>~/apache2-server/conf<span class="o">)</span>
-<span class="o">=</span>&gt;&gt;sudo /opt/local/etc/LaunchDaemons/org.macports.apache2/apache2.wrapper restart
Password:
</code></pre></div>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Stefano Corallo bio photo"></a>
<h3>Stefano Corallo</h3>
<p>Php zendframework doctrine jQuery and other cool stuff</p>


<a href="https://plus.google.com/118069744464640098068" class="author-social" target="_blank"><i class="icon-google-plus"></i> Google+</a>


<a href="http://github.com/https://github.com/stefanorg" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>


        </div>
        <p class="byline"><strong>TEMPLATE Macports Abilitare Apache SSL su Mac OSX Lion</strong> was published on <time datetime="2013-11-25T09:44:37+01:00" itemprop="datePublished">November 25, 2013</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="http://localhost:4000/about" title="About Stefano Corallo" itemprop="url">Stefano Corallo</a></span></span>.</p>
        <section id="disqus_thread"></section>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="http://localhost:4000/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
        
          
        
      
      
      <li><a href="http://localhost:4000/articles/redirigere-richieste-http-to-https" title="Redirigere tutte le richieste http su https tramite Virtual Host">Redirigere tutte le richieste http su https tramite Virtual Host</a></li>
      
    
      
      
        
          
        
      
      
      <li><a href="http://localhost:4000/articles/abilitare-apache-ssl-osx-lion" title="Macports Abilitare Apache SSL su Mac OSX Lion">Macports Abilitare Apache SSL su Mac OSX Lion</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2013 Stefano Corallo. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  var _gaq = _gaq || [];
  var pluginUrl = 
 '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-747635-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'devplayground'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>	        

</body>
</html>
